{"componentChunkName":"component---src-templates-blog-post-js","path":"/android/data-binding/","result":{"data":{"site":{"id":"Site","siteMetadata":{"title":"孙某 Blog"}},"markdownRemark":{"id":"c1508590-4c1f-5c4f-99a0-d7525fb9a763","excerpt":"之前讲了view binding，这回说一下data binding. 测试环境 android-studio 3.6.1   找到app下的build.gradle文件，添加data-binding支持   建立data类: xml必须用layout开头的，建立两个TextVIew用来显示firstName…","html":"<p>之前讲了view binding，这回说一下data binding.</p>\n<p>测试环境 android-studio 3.6.1  </p>\n<p>找到app下的build.gradle文件，添加data-binding支持  </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">android {\n    compileSdkVersion 29\n    buildToolsVersion &quot;29.0.3&quot;\n\n    defaultConfig {\n        applicationId &quot;com.example.componenttest&quot;\n        minSdkVersion 16\n        targetSdkVersion 29\n        versionCode 1\n        versionName &quot;1.0&quot;\n\n        dataBinding {\n            enabled = true\n        }\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile(&#39;proguard-android-optimize.txt&#39;), &#39;proguard-rules.pro&#39;\n        }\n    }\n\n}</code></pre></div>\n<p>建立data类:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">public class User {\n    public final String firstName;\n    public final String lastName;\n    public User(String firstName, String lastName) {\n        this.firstName = firstName;\n        this.lastName = lastName;\n    }\n}</code></pre></div>\n<p>xml必须用layout开头的，建立两个TextVIew用来显示firstName和lastName:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;layout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\n    &lt;data&gt;\n        &lt;variable name=&quot;user&quot; type=&quot;com.example.componenttest.User&quot;/&gt;\n        &lt;variable\n            name=&quot;main&quot;\n            type=&quot;com.example.componenttest.MainActivity&quot; /&gt;\n        &lt;variable\n            name=&quot;handler&quot;\n            type=&quot;com.example.componenttest.MyHandler&quot; /&gt;\n    &lt;/data&gt;\n    &lt;androidx.constraintlayout.widget.ConstraintLayout\n        xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;\n        xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;match_parent&quot;\n        &gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/text&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;19dp&quot;\n            android:text=&quot;@{user.firstName}&quot;\n            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\n            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;\n            app:layout_constraintRight_toRightOf=&quot;parent&quot;\n            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;\n\n        &lt;TextView\n            android:id=&quot;@+id/bindText&quot;\n            android:layout_width=&quot;wrap_content&quot;\n            android:layout_height=&quot;19dp&quot;\n            android:text=&quot;@{user.lastName}&quot;\n            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\n            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;\n            app:layout_constraintRight_toRightOf=&quot;parent&quot;\n            app:layout_constraintTop_toTopOf=&quot;parent&quot;\n            app:layout_constraintVertical_bias=&quot;0.26&quot; /&gt;\n\n        &lt;Button\n            android:id=&quot;@+id/button&quot;\n            android:layout_width=&quot;0dp&quot;\n            android:layout_height=&quot;wrap_content&quot;\n            android:text=&quot;@string/button&quot;\n            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;\n            app:layout_constraintLeft_toLeftOf=&quot;parent&quot;\n            app:layout_constraintRight_toRightOf=&quot;parent&quot;\n            app:layout_constraintTop_toBottomOf=&quot;@+id/text&quot;\n            android:onClick=&quot;changeData&quot;\n            /&gt;\n\n    &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;\n&lt;/layout&gt;</code></pre></div>\n<p>主程序：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import androidx.appcompat.app.AppCompatActivity;\nimport androidx.databinding.DataBindingUtil;\n\nimport android.os.Bundle;\n\nimport com.example.componenttest.databinding.ActivityMainBinding;\n\npublic class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        ActivityMainBinding binding = DataBindingUtil.setContentView(this, R.layout.activity_main);\n        User user = new User(&quot;Qingpeng&quot;, &quot;Sun&quot;);\n        binding.setUser(user);\n    }\n}</code></pre></div>\n<p>效果：\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/22fff32069010673e556e0e95a61cfba/8b70b/data-binding.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.87045813586098%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA4ElEQVQoz53Pu07DMBSA4bPyBog3Y4GRGd6KuUgMdGIHIRjoQMWSS3OBRsSNHefyU1cEqSgX1EifYlm/j3Tk8njN1cmai6NPziTlXD4OlHIq78jLXPF8p3i6VTzOtm4O8zDLub8OELCMq35MNZavIkWMLhlmKTaGjdK781inC0O0ShBrLX3Ksvz9G2P27oa6JNkOdIchLnTDtNZ7D/u6fw9USpFlGWNdt0Ucx0hd14xp2xb3TXVVVZHnOeL5Pr08Dz8IeFsueV0sGOz+ELf3mFUUEYYhU11ncuWmaXamus43cKUs6QHmpaoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"result\"\n        src=\"/static/22fff32069010673e556e0e95a61cfba/fcda8/data-binding.png\"\n        srcset=\"/static/22fff32069010673e556e0e95a61cfba/12f09/data-binding.png 148w,\n/static/22fff32069010673e556e0e95a61cfba/e4a3f/data-binding.png 295w,\n/static/22fff32069010673e556e0e95a61cfba/fcda8/data-binding.png 590w,\n/static/22fff32069010673e556e0e95a61cfba/efc66/data-binding.png 885w,\n/static/22fff32069010673e556e0e95a61cfba/c83ae/data-binding.png 1180w,\n/static/22fff32069010673e556e0e95a61cfba/8b70b/data-binding.png 1266w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>使用可观察数据对象\n改变User类</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import androidx.databinding.ObservableField;\npublic class User {\n    public ObservableField&lt;String&gt; firstName = new ObservableField&lt;&gt;();\n    public ObservableField&lt;String&gt; lastName = new ObservableField&lt;&gt;();\n    public User(String firstName, String lastName) {\n        this.firstName.set(firstName);\n        this.lastName.set(lastName);\n    }\n}</code></pre></div>\n<p>增加Button点击函数</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">public class MainActivity extends AppCompatActivity {\n\n    private User user = new User(&quot;Qingpeng&quot;, &quot;Sun&quot;);\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        ActivityMainBinding binding = DataBindingUtil.setContentView(this, R.layout.activity_main);\n        binding.setUser(user);\n    }\n\n    public void changeData(View view) {\n        user.firstName.set(&quot;Laoshi&quot;);\n    }\n}</code></pre></div>","frontmatter":{"title":"android data binding","tags":["android","data-binding"],"date":"March 10, 2020","description":"android data binding "}}},"pageContext":{"slug":"/android/data-binding/","previous":{"fields":{"slug":"/react/hook/"},"frontmatter":{"title":"react hook特性","tags":["react","hook"]}},"next":{"fields":{"slug":"/android/lifecycle-22/"},"frontmatter":{"title":"弃用 ViewModelProviders.of()，lifecycle2.2变化","tags":["android","lifecycle"]}}}}}