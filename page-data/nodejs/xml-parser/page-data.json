{"componentChunkName":"component---src-templates-blog-post-js","path":"/nodejs/xml-parser/","result":{"data":{"site":{"id":"Site","siteMetadata":{"title":"孙某 Blog"}},"markdownRemark":{"id":"ccc65b0b-0ea8-5ba0-b42f-d2652acf5e88","excerpt":"gatsby的插件gatsby-plugin-sitemap生成的文件是xml格式，而baidu要求主动推送是txt文件。 所以需要把xml转换成txt文件，并且定时向baidu推送。 用fast-xml-parser进行xml解析，其性能是js中最好的。以下是和xml2js的对比：\n 安装： npm i fast…","html":"<p>gatsby的插件gatsby-plugin-sitemap生成的文件是xml格式，而baidu要求主动推送是txt文件。<br>\n所以需要把xml转换成txt文件，并且定时向baidu推送。</p>\n<p>用<a href=\"https://www.npmjs.com/package/fast-xml-parser\">fast-xml-parser</a>进行xml解析，其性能是js中最好的。以下是和xml2js的对比：\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABYElEQVQoz31STUsDMRDdH+8f6EnwKCIIHkRPUqgXTyKIUg+FSv2oH8XudrvJbj5nxpe2WrdSHyHJ7uTNvLxJZq2dzWZa67IsMVdVpZTC3rumrmsikl8glspwjBRjZOYMCzjSBjGPPy3hrLDzsTaBGV8cnB8PRkVR5HlujMlCCCgViTCWEKbGht2Tsao9EvVH6qg3wSZEFkT1PAS/qgwypLJgj9QJqGZc/CHfDtX++duCTIvoGpn3odZqOvfTKiTBSaok8umbNjGRH9RB92NJ3rgdKkch273Oz46vRJwPBEMMSafTm1xe4MTds9vbOZTyFTJgVIsMITH6SWHe7wfRNLiFd94Gehy86NEQJ8o6PN30wzx3kRFtkZduL8xMDfAwA2IwCA4zGolIEkPknN2UvepNiq/8xoIKTdN45zAjtTEN/vt22TV5A/wNZEFx2YJsWwD9wzOQf7GVnG7a7upffAGvg7l9EusvywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"性能对比\"\n        title=\"性能对比\"\n        src=\"/static/c0432861dc1e302f8d7f2d1d3eb68481/fcda8/fxpv3-vs-xml2jsv0419_chart.png\"\n        srcset=\"/static/c0432861dc1e302f8d7f2d1d3eb68481/12f09/fxpv3-vs-xml2jsv0419_chart.png 148w,\n/static/c0432861dc1e302f8d7f2d1d3eb68481/e4a3f/fxpv3-vs-xml2jsv0419_chart.png 295w,\n/static/c0432861dc1e302f8d7f2d1d3eb68481/fcda8/fxpv3-vs-xml2jsv0419_chart.png 590w,\n/static/c0432861dc1e302f8d7f2d1d3eb68481/0a47e/fxpv3-vs-xml2jsv0419_chart.png 600w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>安装：<br>\nnpm i fast-xml-parser</p>\n<p>下面是具体实现的代码，将xml中的url解析后存入了site.txt中</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">var fs = require(&#39;fs&#39;);                                                 \nvar parser = require(&#39;fast-xml-parser&#39;);\n\nvar xmlData = fs.readFileSync(&#39;./public/sitemap.xml&#39;);\nvar txtFile = fs.openSync(&#39;./public/site.txt&#39;, &#39;w&#39;);\n\nvar  dataObj = parser.parse(xmlData.toString());\n\nfor (urlInfo of dataObj.urlset.url) {\n    console.log(urlInfo.loc);\n    fs.writeFileSync(txtFile, urlInfo.loc+&#39;\\n&#39;);\n}\n\nfs.closeSync(txtFile);</code></pre></div>\n<p>其中parse接口使用的默认参数，还可以使用options参数添加更多功能，具体解析如下：<br>\n<font color=blue>attributeNamePrefix</font>: 提供预定的字符串作为属性名称前缀, 比如@_， 这时假设解析的属性为name，那么在解析后的JSON中该属性将会解析为@_name<br>\n<font color=blue>attrNodeName</font>: 将所有属性分组为给定名称的属性， 取代原本的属性名称， 修改为该名称<br>\n<font color=blue>ignoreAttributes</font>: 忽略解析属性， 配置该项的时候不会解析标签内的属性， 默认为true<br>\n<font color=blue>ignoreNameSpace</font>: 从标记和属性名称中移除命名空间字符串<br>\n<font color=blue>allowBooleanAttributes</font>: 标记可以具有不带任何值的属性<br>\n<font color=blue>parseNodeValue </font>: 将属性的值解析为float、integer或boolean<br>\n<font color=blue>parseAttributeValue</font>: 将属性的值解析为float、integer或boolean<br>\n<font color=blue>trimValues</font>: 修剪属性或节点的字符串值<br>\n<font color=blue>cdataTagName</font>: 如果指定，解析器会将CDATA解析为嵌套标记，而不是将其值添加到父标记中<br>\n<font color=blue>cdataPositionChar</font>: 它将有助于将JSON转换回XML，而不会失去CData的位置<br>\n<font color=blue>parseTrueNumberOnly</font>: 如果为真，则像“+123”或“0123”这样的值不会被解析为数字<br>\n<font color=blue>tagValueProcessor</font>: 转换期间处理标记值。如HTML解码、单词大写等，仅适用于字符串<br>\n<font color=blue>attrValueProcessor</font>: 转换期间处理属性值。如HTML解码、单词大写等，仅适用于字符串<br>\n<font color=blue>stopNodes</font>: 不需要解析的标记名数组。相反，它们的值被解析为字符串。  </p>\n<p>参考链接：<a href=\"https://www.jianshu.com/p/d4efd04d43fb\">https://www.jianshu.com/p/d4efd04d43fb</a></p>","frontmatter":{"title":"javascript解析xml文件","tags":["javascript","xml","fast-xml-parser"],"date":"March 01, 2020","description":"用fast-xml-parser解析XML文件"}}},"pageContext":{"slug":"/nodejs/xml-parser/","previous":{"fields":{"slug":"/os/linux-windows-time/"},"frontmatter":{"title":"Linux与windows双系统时间同步","tags":["linux","windows","time"]}},"next":{"fields":{"slug":"/web/nimn/"},"frontmatter":{"title":"最省空间的数据格式，nimn介绍","tags":["data format","nimn","xml","json"]}}}}}